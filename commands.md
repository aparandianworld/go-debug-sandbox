# Go Debugging Commands Cheat Sheet

## Delve
dlv exec # execute a precompiled binary and begin a debug session

```bash
❯ dlv help exec                        
Execute a precompiled binary and begin a debug session.

This command will cause Delve to exec the binary and immediately attach to it to
begin a new debug session. Please note that if the binary was not compiled with
optimizations disabled, it may be difficult to properly debug it. Please
consider compiling debugging binaries with -gcflags="all=-N -l" on Go 1.10
or later, -gcflags="-N -l" on earlier versions of Go.

Usage:
  dlv exec <path/to/binary> [flags]

Flags:
      --continue     Continue the debugged process on start.
  -h, --help         help for exec
      --tty string   TTY to use for the target program

Global Flags:
      --accept-multiclient               Allows a headless server to accept multiple client connections via JSON-RPC or DAP.
      --allow-non-terminal-interactive   Allows interactive sessions of Delve that don't have a terminal as stdin, stdout and stderr
      --api-version int                  Selects JSON-RPC API version when headless. The only valid value is 2. Can be reset via RPCServer.SetApiVersion. See Documentation/api/json-rpc/README.md. (default 2)
      --backend string                   Backend selection (see 'dlv help backend'). (default "default")
      --check-go-version                 Exits if the version of Go in use is not compatible (too old or too new) with the version of Delve. (default true)
      --disable-aslr                     Disables address space randomization
      --headless                         Run debug server only, in headless mode. Server will accept both JSON-RPC or DAP client connections.
      --init string                      Init file, executed by the terminal client.
  -l, --listen string                    Debugging server listen address. Prefix with 'unix:' to use a unix domain socket. (default "127.0.0.1:0")
      --log                              Enable debugging server logging.
      --log-dest string                  Writes logs to the specified file or file descriptor (see 'dlv help log').
      --log-output string                Comma separated list of components that should produce debug output (see 'dlv help log')
      --only-same-user                   Only connections from the same user that started this instance of Delve are allowed to connect. (default true)
  -r, --redirect stringArray             Specifies redirect rules for target process (see 'dlv help redirect')
      --wd string                        Working directory for running the program.
```

```bash
❯ go build -gcflags="all=-N -l"
❯ dlv exec notification-system 
Type 'help' for list of commands.
(dlv) 
```

```bash
dlv exec notification-system
Type 'help' for list of commands.
(dlv) continue
Notifier type: main.EmailNotifier
Notifier type: main.SMSNotifier
Notifier type: main.SlackNotifier
Sending email from from@example.com to to@example.com
Sending SMS to 1234567890
Sending Slack message to #general
All notifications sent.
Process 42440 has exited with status 0
(dlv) 
```

dlv debug # shows compiler diagnostics 

```bash
❯ dlv debug --build-flags="-gcflags=-m"
# github.com/aparandianworld/go-debug-sandbox/notification-system/notification-system
./email_notifier.go:10:6: can inline EmailNotifier.Send
./notifier.go:11:6: can inline describe
./slack_notifier.go:9:6: can inline SlackNotifier.Send
./sms_notifier.go:9:6: can inline SMSNotifier.Send
./main.go:21:11: inlining call to describe
<autogenerated>:1: inlining call to EmailNotifier.Send
<autogenerated>:1: inlining call to SlackNotifier.Send
<autogenerated>:1: inlining call to SMSNotifier.Send
./email_notifier.go:10:7: leaking param: e
./email_notifier.go:10:29: message does not escape
./email_notifier.go:12:12: ... argument does not escape
./email_notifier.go:12:47: e.from escapes to heap
./email_notifier.go:12:55: e.to escapes to heap
./main.go:7:24: []Notifier{...} does not escape
./main.go:8:16: EmailNotifier{...} escapes to heap
./main.go:12:14: SMSNotifier{...} escapes to heap
./main.go:15:16: SlackNotifier{...} escapes to heap
./main.go:21:11: ... argument does not escape
./main.go:27:14: ... argument does not escape
./main.go:31:13: ... argument does not escape
./main.go:31:14: "All notifications sent." escapes to heap
./notifier.go:11:15: leaking param: n
./notifier.go:12:12: ... argument does not escape
./slack_notifier.go:9:7: leaking param: s
./slack_notifier.go:9:29: message does not escape
./slack_notifier.go:11:12: ... argument does not escape
./slack_notifier.go:11:47: s.channel escapes to heap
./sms_notifier.go:9:7: leaking param: s
./sms_notifier.go:9:27: message does not escape
./sms_notifier.go:11:12: ... argument does not escape
./sms_notifier.go:11:37: s.phoneNumber escapes to heap
<autogenerated>:1: ... argument does not escape
<autogenerated>:1: e.from escapes to heap
<autogenerated>:1: e.to escapes to heap
<autogenerated>:1: ... argument does not escape
<autogenerated>:1: s.channel escapes to heap
<autogenerated>:1: ... argument does not escape
<autogenerated>:1: s.phoneNumber escapes to heap
Type 'help' for list of commands.
(dlv)
(dlv) rebuild
# github.com/aparandianworld/go-debug-sandbox/notification-system/notification-system
./email_notifier.go:10:6: can inline EmailNotifier.Send
./notifier.go:11:6: can inline describe
./slack_notifier.go:9:6: can inline SlackNotifier.Send
./sms_notifier.go:9:6: can inline SMSNotifier.Send
./main.go:21:11: inlining call to describe
<autogenerated>:1: inlining call to EmailNotifier.Send
<autogenerated>:1: inlining call to SlackNotifier.Send
<autogenerated>:1: inlining call to SMSNotifier.Send
./email_notifier.go:10:7: leaking param: e
./email_notifier.go:10:29: message does not escape
./email_notifier.go:12:12: ... argument does not escape
./email_notifier.go:12:47: e.from escapes to heap
./email_notifier.go:12:55: e.to escapes to heap
./main.go:7:24: []Notifier{...} does not escape
./main.go:8:16: EmailNotifier{...} escapes to heap
./main.go:12:14: SMSNotifier{...} escapes to heap
./main.go:15:16: SlackNotifier{...} escapes to heap
./main.go:21:11: ... argument does not escape
./main.go:27:14: ... argument does not escape
./main.go:31:13: ... argument does not escape
./main.go:31:14: "All notifications sent." escapes to heap
./notifier.go:11:15: leaking param: n
./notifier.go:12:12: ... argument does not escape
./slack_notifier.go:9:7: leaking param: s
./slack_notifier.go:9:29: message does not escape
./slack_notifier.go:11:12: ... argument does not escape
./slack_notifier.go:11:47: s.channel escapes to heap
./sms_notifier.go:9:7: leaking param: s
./sms_notifier.go:9:27: message does not escape
./sms_notifier.go:11:12: ... argument does not escape
./sms_notifier.go:11:37: s.phoneNumber escapes to heap
<autogenerated>:1: ... argument does not escape
<autogenerated>:1: e.from escapes to heap
<autogenerated>:1: e.to escapes to heap
<autogenerated>:1: ... argument does not escape
<autogenerated>:1: s.channel escapes to heap
<autogenerated>:1: ... argument does not escape
<autogenerated>:1: s.phoneNumber escapes to heap
(dlv)  

```

delv attach # allows you to attach to a running process

```bash
❯ dlv attach 42440
Type 'help' for list of commands.
(dlv) 
```

delv test # allows you to debug your unit tests

```bash
❯ dlv test
Type 'help' for list of commands.
(dlv) 
```

```bash
❯ dlv test -- -test.v
Type 'help' for list of commands.
(dlv) continue
=== RUN   TestHello_With_Assert
--- PASS: TestHello_With_Assert (0.00s)
=== RUN   TestHello_Table_With_Assert
=== RUN   TestHello_Table_With_Assert/Aaron_en
=== RUN   TestHello_Table_With_Assert/Aaron_es
=== RUN   TestHello_Table_With_Assert/Aaron_fr
--- PASS: TestHello_Table_With_Assert (0.00s)
    --- PASS: TestHello_Table_With_Assert/Aaron_en (0.00s)
    --- PASS: TestHello_Table_With_Assert/Aaron_es (0.00s)
    --- PASS: TestHello_Table_With_Assert/Aaron_fr (0.00s)
=== RUN   TestHello_English
--- PASS: TestHello_English (0.00s)
=== RUN   TestHello_Spanish
--- PASS: TestHello_Spanish (0.00s)
=== RUN   TestHello_French
--- PASS: TestHello_French (0.00s)
=== RUN   TestIsEmpty
--- PASS: TestIsEmpty (0.00s)
=== RUN   TestHello_Table
=== RUN   TestHello_Table/Aaron_en
=== RUN   TestHello_Table/Aaron_es
=== RUN   TestHello_Table/Aaron_fr
--- PASS: TestHello_Table (0.00s)
    --- PASS: TestHello_Table/Aaron_en (0.00s)
    --- PASS: TestHello_Table/Aaron_es (0.00s)
    --- PASS: TestHello_Table/Aaron_fr (0.00s)
PASS
Process 58475 has exited with status 0
(dlv) 
(dlv) 
```

